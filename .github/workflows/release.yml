# Quantstop Orderbook Release Workflow

name: Release

on:

  push:
    branches:
      - '**'

  pull_request:
    branches:
      - '**'

  # Allows you to run this workflow manually from the Actions tab
  workflow_dispatch:

permissions:
  contents: write
  # packages: write
  # issues: write

jobs:

  jobs:
    release:
      runs-on: ubuntu-latest
      steps:
        - uses: actions/checkout@v3
          with:
            fetch-depth: 0
        - uses: asdf-vm/actions/install@v1
        - uses: go-semantic-release/action@v1
          with:
            github-token: ${{ secrets.GITHUB_TOKEN }}
        - run: git fetch --all # Re-pull the repo to get the latest tags
        - uses: goreleaser/goreleaser-action@v2
          env:
            GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          with:
            distribution: goreleaser
            version: latest
            args: release --rm-dist
